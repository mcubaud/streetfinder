<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Street Finder Reverse Game</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <link rel="stylesheet" href="balades.css"/>
    <style>
        #recherche_inv{
            display: flex;
            justify-content: space-evenly;
            margin-top: 5px;
            align-items: center;
            background-color: #dbdbdb;
        }

        .clignoter_vert {
            animation: clignoter_vert 500ms linear;
        }
        .secouer_petit_orange {
            animation: secouer_petit_orange 1s linear;
        }
        .secouer_petit {
            animation: secouer_petit 1s linear;
        }
        @keyframes clignoter_vert {
            0% { background-color: white; }
            50% { background-color: green; }
            100% { background-color: white; }
        }
        @keyframes secouer_petit_orange {
            0% { transform: translateX(0); color: orange;}
            25% { transform: translateX(-5px); color: black;}
            75% { transform: translateX(5px); color: orange;}
            100% { transform: translateX(0); color: black;}
        }
        @keyframes secouer_petit {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }

        #div_found{
            height: 200px;
            background-color: black;
            text-shadow: 1px 1px 3px white;
            border: red;
            border-width: 10px;
            border-radius: 10px;
            margin: 0px 15px 15px 15px;
        }
        #list_found{
            height: 80%;
            margin:0px;
            overflow: auto;
        }

        #list_found li{
            cursor: pointer;
        }
        #div_not_found{
            height: 200px;
            background-color: black;
            text-shadow: 1px 1px 3px white;
            border: red;
            border-width: 10px;
            border-radius: 10px;
            margin: 0px 15px 15px 15px;
        }
        #list_not_found{
            height:80%;
            margin:0px;
            overflow: auto;
        }

        #list_not_found li{
            cursor: pointer;
        }

        #div_settings{
            width: 70%;
            height: 70%;
            left: 15%;
            top: 15%;
            background-image: linear-gradient(white, gray);
            z-index: 1000000;
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            border: 1px solid black;
            border-radius: 30px;
            transition: width 2s, height 2s;
        }

        #remaining_time{
            background-color: white;
            border: 1px solid;
            border-radius: 5px;
            text-shadow: black 1px 1px 1px;
        }
    </style>
</head>
<body>
    <header>
        <div id="haut_gauche">
          <!--<button id="localize"></button>-->
          <button id="settings" style="width:30px; height: 30px; background-image: url('https://upload.wikimedia.org/wikipedia/commons/f/fe/Gear-icon-white-background.png'); background-size: 30px;"></button>
        </div>
        <div id='titre'>
        <h1>Retrouver les rues de </h1>
        <h1 style="color: black;"> &#128269</h1>
        <h1> (inverse)</h1>
        </div>
        <div id="boutons">
        <progress id="file" max="100" value="0">0%</progress>
          <p id="score">0 % des rues trouvées</p>
        </div>
    </header>
    <div id="ecran_du_jeu">
        <div id="mapid"></div>
        <div id="container_of_list_of_street">
            <div id="div_found">
                <h3 style="color:white;">Rues trouvées</h3>
                <ul id="list_found"></ul>
            </div>
            <div id="div_not_found">
                <h3 style="color:white;">Rues pas trouvées</h3>
                <ul id="list_not_found"></ul>
            </div>
            <button id="save">Sauvegarder ma progression</button>
            <label for="upload">Charger une sauvegarde:</label>
            <input type="file" name="upload" id="upload" accept=".json"/>
        </div>
    </div>
    <div id="recherche_inv">
        <p id="target_street"></p>
        <p id="remaining_attempts">3 remaining attempts</p>
        <p id="remaining_time"></p>
        <button id="passer">Passer</button>
    </div>

    <audio id="bad_bip" src="https://universal-soundbank.com/sounds/2042.mp3"></audio>
    <audio id="very_bad_bip" src="https://universal-soundbank.com/sounds/1315.mp3"></audio>
    <audio id="good_bip" src="https://universal-soundbank.com/sounds/4063.mp3"></audio>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        var lieu = localStorage.getItem("lieu");

        if( lieu === null){
            lieu = "Rennes";
        }

        console.log(lieu);
        ///Changer le nom de la page
        document.getElementById("titre").children[0].innerHTML += lieu;
        document.title += " " + lieu;
        ///affichage de la carte
        var mymap;
        if(lieu == "Lyon"){
            mymap = L.map('mapid').setView([45.75728373443727, 4.849433898925782], 13);
            centre = ([45.76760066596194, 4.833500872177675]);
        }
        if(lieu == "Rennes"){
            mymap = L.map('mapid').setView([48.11105621460431, -1.676739113603782], 13);
            centre = ([48.11105621460431, -1.676739113603782]);
        }

        L.tileLayer('http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png', {
          attribution: 'Map data &copy; <a href="https://openstreetmap.org">OpenStreetMap</a> contributors'
        }).addTo(mymap);

        var json_balades = {};

        var promise0 = new Promise((resolve, reject) => {
            var geojson = (lieu == "Lyon") ? "rues.geojson" : "rues_rennes.geojson";
            fetch(geojson)
            .then(r => r.json())
            .then(r => {
                json_balades = r;
                resolve(r);
            });
        });

        var promise = promise0;
        var total_length = 0;
        var find_length = 0;
        var not_find_length = 0;
        var polylines = {};
        var names = {};
        var trouves = {};
        var trouves_uniques = [];
        var currentStreetIndex = 0;
        var initial_attempts = localStorage.getItem("initial_attempts");
        if( initial_attempts === null){
            initial_attempts = 3;
        }
        var attemptsLeft = initial_attempts;
        var mode = localStorage.getItem("mode");
        if( mode === null){
            mode = "par_distance_au_centre_predefini";
        }
        
        var timer;
        var timer_type = localStorage.getItem("timer_type")
        if(timer_type === null){
            timer_type = "local";
        }
        var initial_time = localStorage.getItem("duree_chrono")
        if( initial_time === null){
            if(timer_type =="local"){
                initial_time = 30;
            }if(timer_type =="global"){
                initial_time = 3600;
            }if(timer_type =="no"){
                initial_time = "illimité";
            }
        }
        var time = initial_time;

        promise
        .then(r => {
            var array = r.features;
            array = sort_street(array, mode);
            
            for(var i = 0; i < array.length; i++){
                var obj = array[i];
                var lnglats = obj.geometry.coordinates;
                var latlngs = lnglats.map(x => [x[1], x[0]]);

                try{
                    var polyline = L.polyline(latlngs, {color: '#3b364b'}).addTo(mymap);
                    polyline.nom = obj.properties.name;
                    polyline.i = i;
                    var other_tags = obj.properties.other_tags;
                    if (other_tags && other_tags.includes("\"wikipedia\"=>\"")){
                        try{
                            polyline.wiki = other_tags.split("\"wikipedia\"=>\"")[1].split("\"")[0];
                            console.log(polyline.wiki);
                        }finally{}
                    }
                    polyline.length = obj.properties.length;
                    total_length += polyline.length;
                    polyline._path.nom = polyline.nom;
                    polyline._path.i = i;
                    polyline._path.onclick = check_clicked_street;
                    polylines[i] = polyline;
                    names[i] = obj.properties.name;
                    trouves[i] = false;
                }finally{}
            }
            askNextStreet();
            if(timer_type=="global"){
                launch_timer();
            }
        });


        function sort_street(array, mode){
            if(mode=="par_distance_au_centre"){
                sum_x = 0
                sum_y = 0
                for(var i = 0; i < array.length; i++){
                    sum_x+=array[i].geometry.coordinates[0][0]
                sum_y+=array[i].geometry.coordinates[0][1]
                }
                for(var i = 0; i < array.length; i++){
                    array[i].distance=Math.sqrt((array[i].geometry.coordinates[0][0]-sum_x/array.length)**2 + (array[i].geometry.coordinates[0][1]-sum_y/array.length)**2 )
                }
                array.sort((a, b) => a.distance - b.distance);
                return array
            }
            if(mode=="par_distance_au_centre_predefini"){
                for(var i = 0; i < array.length; i++){
                    array[i].distance=Math.sqrt((array[i].geometry.coordinates[0][0]-centre[1])**2 + (array[i].geometry.coordinates[0][1]-centre[0])**2 )
                }
                array.sort((a, b) => a.distance - b.distance);
                return array
            }
            if(mode=="par_taille_des_segments"){
                array.sort((a, b) => b.properties.length - a.properties.length);
                return array
            }
            if(mode=="par_longueur_totale"){
                for(var i = 0; i < array.length; i++){
                    var longueur=0
                    var name = array[i].properties.name
                    for(var j = 0; j < array.length; j++){
                        if(name === array[j].properties.name){
                            longueur+=array[j].properties.length;
                        }
                    }
                    array[i].longueur=longueur;
                }
                array.sort((a, b) => b.longueur - a.longueur)
                return array

            }
            if(mode=="random"){
                array.sort((a, b) => Math.random() - Math.random());
                return array
            }
            else{
                return array
            }
        }

        function print_score(){
            var asked_length = find_length + not_find_length;
            if(asked_length==0){
                document.getElementById("score").innerHTML = Math.round(find_length/1000) + " / " + Math.round(asked_length/1000) + " km (" + 0 + "%) des rues trouvées";
                document.getElementById("score").style["color"] = couleur_par_score(0);
            }else{
                document.getElementById("score").innerHTML = Math.round(find_length/1000) + " / " + Math.round(asked_length/1000) + " km (" + Math.round(100*find_length/asked_length) + "%) des rues trouvées";
                document.getElementById("score").style["color"] = couleur_par_score(find_length/asked_length);
            }
            
        }





        function chercher(){
            var adresse = $("#inputAdresse").val();
            console.log(adresse);
            if(adresse != ""){
                var found = false;
                var alreadyFound = false;
                var last_already;
                for(let i in polylines){
                    var name2 = names[i];
                    if(are_similar(adresse, name2)){
                        if(trouves[i]){
                            alreadyFound = true;
                            last_already = polylines[i];
                        }
                        else{
                            if (i == currentStreetIndex) {
                                polylines[i].setStyle({"color":"green"});
                                polylines[i].bindTooltip(name2);
                                if(polylines[i].wiki){
                                    var [langue, page] = polylines[i].wiki.split(":");
                                    polylines[i].bindPopup(
                                        "<iframe style='height:400px;' src='https://" + langue + ".m.wikipedia.org/wiki/" + page + "'></iframe>"
                                    );
                                }
                                found = true;
                                find_length += polylines[i].length;
                                trouves[i] = true;
                                if (!trouves_uniques.includes(name2)){
                                    add_in_list_found(name2, polylines[i]);
                                }
                                break;
                            }
                        }
                    }
                }
                if(found){
                    document.getElementById("inputAdresse").value = "";
                    print_score();
                    inputAdresse.classList.add("clignoter_vert");
                    setTimeout(() => { inputAdresse.classList.remove("clignoter_vert"); }, 1000);
                    askNextStreet();
                } else if(alreadyFound){
                    last_already.openPopup();
                    mymap.flyToBounds(last_already.getBounds());
                    inputAdresse.classList.add("secouer_petit_orange");
                    setTimeout(() => { inputAdresse.classList.remove("secouer_petit_orange"); }, 1000);
                } else {
                    inputAdresse.classList.add("secouer_petit");
                    setTimeout(() => { inputAdresse.classList.remove("secouer_petit"); }, 1000);
                    attemptsLeft--;
                    if (attemptsLeft <= 0) {
                        alert("You lost! No more attempts left.");
                        // Optionally, you can reset the game here
                        resetGame();
                    }
                }
            }
        }

        function standardize(str){
            str = str.toLowerCase().replace(/-/g, " ").replace(/œ/g, "oe").replace(/'/g, "' ");
            var lettres_accentuees = "àäâéèêëîïôöùüûÿ".split("");
            var lettres_normales = "aaaeeeeiioouuuy".split("");
            for(let i = 0; i < lettres_normales.length; i++){
                str = str.replace(new RegExp(lettres_accentuees[i], 'g'), lettres_normales[i]);
            }
            return str;
        }


        function are_similar(nom1, nom2){
            var exact_match = standardize(nom1)==standardize(nom2);
            var regex_rues = /\brue |\bavenue |\bboulevard |\bcours |\bplace |\bimpasse |\ballée |\bruelle |\bpassage |\bpont |\bmontée |\bquai |\btunnel |\bgrande rue |\bmontee |\ballee |\bbretelle |\bmail |\bcite |\banse |\bcarrefour |\bchaussee |\bchemin |\bclos |\bcote |\bcour |\bcours |\bdegre |\bdescente |\bdreve |\bescoussiere |\besplanade |\bgaffe |\bgrand route |\bliaison |\bplacette |\bpromenade |\bresidence |\brang |\brampe |\brond point |\broute |\bruelle |\bsente |\bsentier |\bsquare |\btraverse |\bvenelle |\bvoie |\bberge |\bdigue /g;
            var regex_stop_words = /\ble |\bla |\bl' |\bles |\bde |\bdu |\bdes |\bd' |\bun |\bune |\bl |\bd /g;
            var regex_military = /\bamiral |\bcaporal |\blieutenant |\bcapitaine |\bmajor |\bgénéral |\bgeneral |\bcolonel |\bmarechal |\blieutenant colonel |\bsergent |\bsergent chef |\badjudant |\bsous lieutenant |\bcommandant |\bpresident /g;
            var partial_match = standardize(nom1).replaceAll(regex_stop_words,"")==standardize(nom2).replaceAll(regex_rues,"").replaceAll(regex_stop_words,"").replaceAll(regex_military, "");
            return exact_match | partial_match;
            }


        function askNextStreet(){
            if (currentStreetIndex < Object.keys(names).length) {
                targetstreetName = names[currentStreetIndex];
                if(trouves_uniques.includes(targetstreetName)){
                    currentStreetIndex++;
                    askNextStreet();
                }
                print_score()
                document.getElementById("target_street").innerHTML = "<b>Rue à trouver </b>: "+targetstreetName
                attemptsLeft = initial_attempts;
                document.getElementById("remaining_attempts").innerHTML = attemptsLeft+" tentatives restantes";
                if(timer_type == "local"){
                    launch_timer();
                }
                currentStreetIndex++;
            } else {
                alert("Bravo ! Vous avez trouvé toutes les rues !");
                print_score()
            }
        }

        document.getElementById("passer").onclick=function(){
            color_roads(targetstreetName, "red");
            askNextStreet()
        }

        function launch_timer(){
            clearInterval(timer);
            time = initial_time;
            timer = setInterval(function(){
                time--
                document.getElementById("remaining_time").innerHTML=time+"s"
                document.getElementById("remaining_time").style.color=couleur_par_score(time/initial_time);
                if(time<=0){
                    clearInterval(timer);
                    if(timer_type == "local"){
                        color_roads(targetstreetName, "red");
                        document.getElementById("very_bad_bip").play();
                        askNextStreet();
                    }
                    if(timer_type == "global"){
                        alert("Temps écoulé ! Perdu");
                        window.location=""
                    }
                }
            }, 1000)
        }

        function check_clicked_street(e){
            console.log(e.target);
            polyline = e.target
            name2 = polyline.nom
            if( are_similar(targetstreetName, name2) ){
                trouves[polylines.i]=true;
                color_roads(targetstreetName, "green");
                document.getElementById("good_bip").play();
                askNextStreet();
            }else{
                attemptsLeft -=1;
                document.getElementById("remaining_attempts").classList.add("secouer_petit_orange");
                setTimeout(() => { document.getElementById("remaining_attempts").classList.remove("secouer_petit_orange"); }, 1000);
                
                document.getElementById("remaining_attempts").innerHTML = attemptsLeft+" tentatives restantes";
                if(attemptsLeft<=0){
                    color_roads(targetstreetName, "red");
                    document.getElementById("very_bad_bip").play();
                    askNextStreet();
                }else{
                    document.getElementById("bad_bip").play();
                    if(attemptsLeft==1){
                        document.getElementById("remaining_attempts").innerHTML = attemptsLeft+" tentative restante";
                    }
                }
            }
        }

        function color_roads(name, color){
            for(let i in polylines){
                    var name2 = names[i];
                    if(are_similar(name, name2)){
                        trouves[i] = true;
                        polylines[i].setStyle({"color":color});
                        polylines[i].bindTooltip(name2);   
                        if(polylines[i].wiki){
                            var [langue, page] = polylines[i].wiki.split(":");
                            polylines[i].bindPopup(
                                "<iframe style='height:400px;' src='https://" + langue + ".m.wikipedia.org/wiki/" + page + "'></iframe>"
                            );
                        }
                        if(color=="green"){
                            find_length += polylines[i].length;
                        }else{
                            not_find_length += polylines[i].length;

                        }
                        if (!trouves_uniques.includes(name2)){
                            if(color=="green"){
                                add_in_list_found(name2, polylines[i]);
                            }else{
                                add_in_list_not_found(name2, polylines[i]);

                            }
                            
                        }
                    }
                }
        }

        function resetGame() {
            // Reset game logic here if needed
            location.reload();
        }

        function couleur_par_score(pts){
            if(pts < 0.5){
              return rgbToHex(
                  Math.floor(255),
                  Math.floor(255 * 2 * pts),
                  0);
            }else{
              return rgbToHex(
                  Math.floor(255 - 255 * pts / 2),
                  Math.floor(255),
                  0);
            }
        }

        function componentToHex(c) {
            let hex = c.toString(16);
            return hex.length == 1 ? "0" + hex : hex;
        }

        function rgbToHex(r, g, b) {
            return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
        }

        function hexToRgb(hex){
            var r = parseInt(hex.slice(1, 3), 16);
            var g = parseInt(hex.slice(3, 5), 16);
            var b = parseInt(hex.slice(5, 7), 16);
            return [r, g, b];
        }

        function downloadObjectAsJson(exportObj, exportName){
            var dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(exportObj));
            var downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", exportName + ".json");
            document.body.appendChild(downloadAnchorNode); // required for firefox
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
        }

        document.getElementById("save").onclick = function(){
            downloadObjectAsJson(trouves, "streetfinder_save_" + lieu);
        }

        function upload_save(saved_trouvees){
            for(let i in polylines){
                var name2 = names[i];
                if(saved_trouvees[i]){
                    polylines[i].setStyle({"color":"green"});
                    polylines[i].bindTooltip(name2);
                    if(polylines[i].wiki){
                        var [langue, page] = polylines[i].wiki.split(":");
                        polylines[i].bindPopup(
                            "<iframe style='height:400px;' src='https://" + langue + ".m.wikipedia.org/wiki/" + page + "'></iframe>"
                        );
                    }
                    if (!trouves[i]){
                        find_length += polylines[i].length;
                        trouves[i] = true;
                    }
                    if (!trouves_uniques.includes(name2)){
                        add_in_list_found(name2, polylines[i]);
                    }
                }
            }
            print_score();
        }

        function add_in_list_found(name, thispolyline){
            var name_std = standardize(name).replace(/' /g, "_").replace(/ /g, "_");
            var li = document.createElement("li");
            li.innerHTML = "<li id='list_found_" + name_std + "'>" + name + "</li>";
            document.getElementById("list_found").appendChild(li);
            document.getElementById("list_found_" + name_std).onclick = function(){
                thispolyline.openTooltip();
                mymap.panTo(thispolyline._latlngs[0], thispolyline._latlngs[1]);
            }
            document.getElementById("list_found_" + name_std).scrollIntoView();
            trouves_uniques.push(name);
        }
        function add_in_list_not_found(name, thispolyline){
            var name_std = standardize(name).replace(/' /g, "_").replace(/ /g, "_");
            var li = document.createElement("li");
            li.innerHTML = "<li id='list_not_found_" + name_std + "'>" + name + "</li>";
            document.getElementById("list_not_found").appendChild(li);
            document.getElementById("list_not_found_" + name_std).onclick = function(){
                thispolyline.openTooltip();
                mymap.panTo(thispolyline._latlngs[0], thispolyline._latlngs[1]);
            }
            document.getElementById("list_not_found_" + name_std).scrollIntoView();
            trouves_uniques.push(name);
        }

        document.getElementById("upload").onchange = function(){
            var file = document.getElementById("upload").files[0];
            var urlfile = URL.createObjectURL(file);
            fetch(urlfile)
            .then(r => r.json())
            .then(r => upload_save(r));
        }

        document.getElementById("settings").onclick = function(){
            if(document.getElementById("div_settings")!=null){
                document.getElementById("div_settings").remove();
            }else{

                div_settings = document.createElement("div");
                div_settings.id = "div_settings";
                div_settings.innerHTML=`
                <h2>Paramètres</h2>
                <div>
                    <div>
                        <label for="choix_lieu">Choix de la ville :</label>
                        <select name="choix_lieu" id="choix_lieu">
                        <option value="Rennes" ${lieu=="Rennes"? "selected" : ""}>Rennes</option>
                        <option value="Lyon" selected='${lieu=="Lyon"? "selected" : ""}'>Lyon</option>
                        </select>
                    </div>
                    <div>
                        <label for="asked_order">Ordre de demande des rues :</label>
                        <select name="asked_order" id="asked_order">
                        <option value="par_distance_au_centre_predefini" ${mode=="par_distance_au_centre_predefini"? "selected" : ""}>Par distance à un centre prédéfini</option>
                        <option value="par_distance_au_centre" ${mode=="par_distance_au_centre"? "selected" : ""}>Par distance à un centre calculé</option>
                        <option value="par_taille_des_segments" ${mode=="par_taille_des_segments"? "selected" : ""}>Par taille des segments</option>
                        <option value="par_longueur_totale" ${mode=="par_longueur_totale"? "selected" : ""}>Par longueur totale de la rue (lent)</option>
                        <option value="random" ${mode=="random"? "selected" : ""}>Ordre aléatoire</option>
                        </select>
                    </div>
                    <div>
                        <label for="attempts_number_select">Nombre de tentatives :</label>
                        <input type="number" id="attempts_number_select" name="attempts_number_select" min="1" max="5" value=${initial_attempts}>
                    </div>
                    <div>
                        <label for="timer_type">Type de chrono :</label>
                        <select name="timer_type" id="timer_type">
                        <option value="local" ${timer_type=="local"? "selected" : ""}>Temps limité par rue</option>
                        <option value="global" ${timer_type=="global"? "selected" : ""}>Temps limité pour toutes les rues</option>
                        <option value="no" ${timer_type=="no"? "selected" : ""}>Pas de temps limité</option>
                        </select>
                    </div>
                    <div id="div_duree_chrono" style="visibility:${(timer_type=="no")? 'hidden' : 'visible'};">
                        <label for="duree_chrono">Durée du chrono (s):</label>
                        <input type="number" id="duree_chrono" name="duree_chrono" min="1" value="30" step="1">
                    </div>
                </div>
                <div style="display: flex">
                    <button id="valider">Valider et relancer la partie</button>
                    <button id="revenir">Annuler et revenir à la partie</button>
                </div>
                `;
                document.querySelector("body").appendChild(div_settings);
                document.getElementById("timer_type").onchange=function(){
                    if(document.getElementById("timer_type").value=="no"){
                        document.getElementById("div_duree_chrono").style.visibility="hidden";
                    }
                    if(document.getElementById("timer_type").value=="local"){
                        document.getElementById("div_duree_chrono").style.visibility="visible";
                        document.getElementById("duree_chrono").outerHTML=`<input type="number" id="duree_chrono" name="duree_chrono" min="1" value="30" step="1">`;
                    }
                    if(document.getElementById("timer_type").value=="global"){
                        document.getElementById("div_duree_chrono").style.visibility="visible";
                        document.getElementById("duree_chrono").outerHTML=`<input type="number" id="duree_chrono" name="duree_chrono" min="1" value="3600" step="60">`;
                    }
                }

                document.getElementById("revenir").onclick=function(){
                    document.getElementById("div_settings").remove();
                }
                document.getElementById("valider").onclick=function(){
                    localStorage.setItem("lieu", document.getElementById("choix_lieu").value);
                    localStorage.setItem("mode", document.getElementById("asked_order").value);
                    localStorage.setItem("initial_attempts", document.getElementById("attempts_number_select").value);
                    localStorage.setItem("timer_type", document.getElementById("timer_type").value);
                    localStorage.setItem("duree_chrono", document.getElementById("duree_chrono").value);
                    window.location = "";
                }
            }
        }
    </script>
</body>
</html>
